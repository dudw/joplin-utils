import{aF as se,r as re,R as A,z as H,B as ae}from"./index.390dc114.js";import{B as K,j as te,i as le}from"./joplinApiGenerator.74e9e026.js";import{m as ce,P as fe}from"./index.esm.af52872f.js";import{F as U}from"./index.1a464146.js";import{C as de}from"./index.9a24dd67.js";import{I as ie}from"./index.64e738dc.js";import{S as he}from"./index.3c805006.js";import{L as ne}from"./index.4ce05cdc.js";import"./TextArea.7db41e2e.js";import"./EyeOutlined.1c663690.js";const pe="_ReplaceView_3ezz3_1",ve="_content_3ezz3_7";var ue={ReplaceView:pe,content:ve},oe={exports:{}};(function(L){L.exports=function(p){var O={};function e(i){if(O[i])return O[i].exports;var a=O[i]={exports:{},id:i,loaded:!1};return p[i].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}return e.m=p,e.c=O,e.p="",e(0)}([function(p,O,e){p.exports=e(1)},function(p,O,e){Object.defineProperty(O,"__esModule",{value:!0});function i(s){return s&&s.__esModule?s:{default:s}}var a=e(2),h=i(a);O.default=h.default,p.exports=O.default},function(p,O,e){Object.defineProperty(O,"__esModule",{value:!0});var i=Object.assign||function(r){for(var l=1;l<arguments.length;l++){var S=arguments[l];for(var v in S)Object.prototype.hasOwnProperty.call(S,v)&&(r[v]=S[v])}return r};O.default=f;function a(r){return r&&r.__esModule?r:{default:r}}function h(r,l){var S={};for(var v in r)l.indexOf(v)>=0||!Object.prototype.hasOwnProperty.call(r,v)||(S[v]=r[v]);return S}var s=e(3),b=e(4),n=a(b),u=e(14),d=e(15),g=a(d);f.propTypes={activeClassName:n.default.string,activeIndex:n.default.number,activeStyle:n.default.object,autoEscape:n.default.bool,className:n.default.string,findChunks:n.default.func,highlightClassName:n.default.oneOfType([n.default.object,n.default.string]),highlightStyle:n.default.object,highlightTag:n.default.oneOfType([n.default.node,n.default.func,n.default.string]),sanitize:n.default.func,searchWords:n.default.arrayOf(n.default.oneOfType([n.default.string,n.default.instanceOf(RegExp)])).isRequired,textToHighlight:n.default.string.isRequired,unhighlightClassName:n.default.string,unhighlightStyle:n.default.object};function f(r){var l=r.activeClassName,S=l===void 0?"":l,v=r.activeIndex,y=v===void 0?-1:v,c=r.activeStyle,R=r.autoEscape,k=r.caseSensitive,$=k===void 0?!1:k,F=r.className,X=r.findChunks,B=r.highlightClassName,z=B===void 0?"":B,D=r.highlightStyle,Y=D===void 0?{}:D,J=r.highlightTag,Z=J===void 0?"mark":J,V=r.sanitize,W=r.searchWords,Q=r.textToHighlight,N=r.unhighlightClassName,G=N===void 0?"":N,_=r.unhighlightStyle,ee=h(r,["activeClassName","activeIndex","activeStyle","autoEscape","caseSensitive","className","findChunks","highlightClassName","highlightStyle","highlightTag","sanitize","searchWords","textToHighlight","unhighlightClassName","unhighlightStyle"]),t=(0,s.findAll)({autoEscape:R,caseSensitive:$,findChunks:X,sanitize:V,searchWords:W,textToHighlight:Q}),o=Z,E=-1,C="",m=void 0,j=function(w){var P={};for(var I in w)P[I.toLowerCase()]=w[I];return P},x=(0,g.default)(j);return(0,u.createElement)("span",i({className:F},ee,{children:t.map(function(T,w){var P=Q.substr(T.start,T.end-T.start);if(T.highlight){E++;var I=void 0;typeof z=="object"?$?I=z[P]:(z=x(z),I=z[P.toLowerCase()]):I=z;var M=E===+y;C=I+" "+(M?S:""),m=M===!0&&c!=null?Object.assign({},Y,c):Y;var q={children:P,className:C,key:w,style:m};return typeof o!="string"&&(q.highlightIndex=E),(0,u.createElement)(o,q)}else return(0,u.createElement)("span",{children:P,className:G,key:w,style:_})})}))}p.exports=O.default},function(p,O){p.exports=function(e){var i={};function a(h){if(i[h])return i[h].exports;var s=i[h]={exports:{},id:h,loaded:!1};return e[h].call(s.exports,s,s.exports,a),s.loaded=!0,s.exports}return a.m=e,a.c=i,a.p="",a(0)}([function(e,i,a){e.exports=a(1)},function(e,i,a){Object.defineProperty(i,"__esModule",{value:!0});var h=a(2);Object.defineProperty(i,"combineChunks",{enumerable:!0,get:function(){return h.combineChunks}}),Object.defineProperty(i,"fillInChunks",{enumerable:!0,get:function(){return h.fillInChunks}}),Object.defineProperty(i,"findAll",{enumerable:!0,get:function(){return h.findAll}}),Object.defineProperty(i,"findChunks",{enumerable:!0,get:function(){return h.findChunks}})},function(e,i){Object.defineProperty(i,"__esModule",{value:!0}),i.findAll=function(d){var g=d.autoEscape,f=d.caseSensitive,r=f===void 0?!1:f,l=d.findChunks,S=l===void 0?h:l,v=d.sanitize,y=d.searchWords,c=d.textToHighlight;return s({chunksToHighlight:a({chunks:S({autoEscape:g,caseSensitive:r,sanitize:v,searchWords:y,textToHighlight:c})}),totalLength:c?c.length:0})};var a=i.combineChunks=function(d){var g=d.chunks;return g=g.sort(function(f,r){return f.start-r.start}).reduce(function(f,r){if(f.length===0)return[r];var l=f.pop();if(r.start<=l.end){var S=Math.max(l.end,r.end);f.push({start:l.start,end:S})}else f.push(l,r);return f},[]),g},h=function(d){var g=d.autoEscape,f=d.caseSensitive,r=d.sanitize,l=r===void 0?b:r,S=d.searchWords,v=d.textToHighlight;return v=l(v),S.filter(function(y){return y}).reduce(function(y,c){c=l(c),g&&(c=n(c));for(var R=new RegExp(c,f?"g":"gi"),k=void 0;k=R.exec(v);){var $=k.index,F=R.lastIndex;F>$&&y.push({start:$,end:F}),k.index==R.lastIndex&&R.lastIndex++}return y},[])};i.findChunks=h;var s=i.fillInChunks=function(d){var g=d.chunksToHighlight,f=d.totalLength,r=[],l=function(y,c,R){c-y>0&&r.push({start:y,end:c,highlight:R})};if(g.length===0)l(0,f,!1);else{var S=0;g.forEach(function(v){l(S,v.start,!1),l(v.start,v.end,!0),S=v.end}),l(S,f,!1)}return r};function b(u){return u}function n(u){return u.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}}])},function(p,O,e){(function(i){p.exports=e(13)()}).call(O,e(5))},function(p,O){var e=p.exports={},i,a;function h(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?i=setTimeout:i=h}catch{i=h}try{typeof clearTimeout=="function"?a=clearTimeout:a=s}catch{a=s}})();function b(y){if(i===setTimeout)return setTimeout(y,0);if((i===h||!i)&&setTimeout)return i=setTimeout,setTimeout(y,0);try{return i(y,0)}catch{try{return i.call(null,y,0)}catch{return i.call(this,y,0)}}}function n(y){if(a===clearTimeout)return clearTimeout(y);if((a===s||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(y);try{return a(y)}catch{try{return a.call(null,y)}catch{return a.call(this,y)}}}var u=[],d=!1,g,f=-1;function r(){!d||!g||(d=!1,g.length?u=g.concat(u):f=-1,u.length&&l())}function l(){if(!d){var y=b(r);d=!0;for(var c=u.length;c;){for(g=u,u=[];++f<c;)g&&g[f].run();f=-1,c=u.length}g=null,d=!1,n(y)}}e.nextTick=function(y){var c=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)c[R-1]=arguments[R];u.push(new S(y,c)),u.length===1&&!d&&b(l)};function S(y,c){this.fun=y,this.array=c}S.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function v(){}e.on=v,e.addListener=v,e.once=v,e.off=v,e.removeListener=v,e.removeAllListeners=v,e.emit=v,e.prependListener=v,e.prependOnceListener=v,e.listeners=function(y){return[]},e.binding=function(y){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(y){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(p,O,e){(function(i){var a=e(7),h=e(8),s=e(9),b=e(10),n=e(11),u=e(12);p.exports=function(d,g){var f=typeof Symbol=="function"&&Symbol.iterator,r="@@iterator";function l(t){var o=t&&(f&&t[f]||t[r]);if(typeof o=="function")return o}var S="<<anonymous>>",v={array:k("array"),bool:k("boolean"),func:k("function"),number:k("number"),object:k("object"),string:k("string"),symbol:k("symbol"),any:$(),arrayOf:F,element:X(),instanceOf:B,node:J(),objectOf:D,oneOf:z,oneOfType:Y,shape:Z,exact:V};function y(t,o){return t===o?t!==0||1/t===1/o:t!==t&&o!==o}function c(t){this.message=t,this.stack=""}c.prototype=Error.prototype;function R(t){function o(C,m,j,x,T,w,P){return x=x||S,w=w||j,P!==n&&g&&h(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types"),m[j]==null?C?m[j]===null?new c("The "+T+" `"+w+"` is marked as required "+("in `"+x+"`, but its value is `null`.")):new c("The "+T+" `"+w+"` is marked as required in "+("`"+x+"`, but its value is `undefined`.")):null:t(m,j,x,T,w)}var E=o.bind(null,!1);return E.isRequired=o.bind(null,!0),E}function k(t){function o(E,C,m,j,x,T){var w=E[C],P=N(w);if(P!==t){var I=G(w);return new c("Invalid "+j+" `"+x+"` of type "+("`"+I+"` supplied to `"+m+"`, expected ")+("`"+t+"`."))}return null}return R(o)}function $(){return R(a.thatReturnsNull)}function F(t){function o(E,C,m,j,x){if(typeof t!="function")return new c("Property `"+x+"` of component `"+m+"` has invalid PropType notation inside arrayOf.");var T=E[C];if(!Array.isArray(T)){var w=N(T);return new c("Invalid "+j+" `"+x+"` of type "+("`"+w+"` supplied to `"+m+"`, expected an array."))}for(var P=0;P<T.length;P++){var I=t(T,P,m,j,x+"["+P+"]",n);if(I instanceof Error)return I}return null}return R(o)}function X(){function t(o,E,C,m,j){var x=o[E];if(!d(x)){var T=N(x);return new c("Invalid "+m+" `"+j+"` of type "+("`"+T+"` supplied to `"+C+"`, expected a single ReactElement."))}return null}return R(t)}function B(t){function o(E,C,m,j,x){if(!(E[C]instanceof t)){var T=t.name||S,w=ee(E[C]);return new c("Invalid "+j+" `"+x+"` of type "+("`"+w+"` supplied to `"+m+"`, expected ")+("instance of `"+T+"`."))}return null}return R(o)}function z(t){if(!Array.isArray(t))return a.thatReturnsNull;function o(E,C,m,j,x){for(var T=E[C],w=0;w<t.length;w++)if(y(T,t[w]))return null;var P=JSON.stringify(t);return new c("Invalid "+j+" `"+x+"` of value `"+T+"` "+("supplied to `"+m+"`, expected one of "+P+"."))}return R(o)}function D(t){function o(E,C,m,j,x){if(typeof t!="function")return new c("Property `"+x+"` of component `"+m+"` has invalid PropType notation inside objectOf.");var T=E[C],w=N(T);if(w!=="object")return new c("Invalid "+j+" `"+x+"` of type "+("`"+w+"` supplied to `"+m+"`, expected an object."));for(var P in T)if(T.hasOwnProperty(P)){var I=t(T,P,m,j,x+"."+P,n);if(I instanceof Error)return I}return null}return R(o)}function Y(t){if(!Array.isArray(t))return a.thatReturnsNull;for(var o=0;o<t.length;o++){var E=t[o];if(typeof E!="function")return s(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",_(E),o),a.thatReturnsNull}function C(m,j,x,T,w){for(var P=0;P<t.length;P++){var I=t[P];if(I(m,j,x,T,w,n)==null)return null}return new c("Invalid "+T+" `"+w+"` supplied to "+("`"+x+"`."))}return R(C)}function J(){function t(o,E,C,m,j){return W(o[E])?null:new c("Invalid "+m+" `"+j+"` supplied to "+("`"+C+"`, expected a ReactNode."))}return R(t)}function Z(t){function o(E,C,m,j,x){var T=E[C],w=N(T);if(w!=="object")return new c("Invalid "+j+" `"+x+"` of type `"+w+"` "+("supplied to `"+m+"`, expected `object`."));for(var P in t){var I=t[P];if(!!I){var M=I(T,P,m,j,x+"."+P,n);if(M)return M}}return null}return R(o)}function V(t){function o(E,C,m,j,x){var T=E[C],w=N(T);if(w!=="object")return new c("Invalid "+j+" `"+x+"` of type `"+w+"` "+("supplied to `"+m+"`, expected `object`."));var P=b({},E[C],t);for(var I in P){var M=t[I];if(!M)return new c("Invalid "+j+" `"+x+"` key `"+I+"` supplied to `"+m+"`.\nBad object: "+JSON.stringify(E[C],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(t),null,"  "));var q=M(T,I,m,j,x+"."+I,n);if(q)return q}return null}return R(o)}function W(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(W);if(t===null||d(t))return!0;var o=l(t);if(o){var E=o.call(t),C;if(o!==t.entries){for(;!(C=E.next()).done;)if(!W(C.value))return!1}else for(;!(C=E.next()).done;){var m=C.value;if(m&&!W(m[1]))return!1}}else return!1;return!0;default:return!1}}function Q(t,o){return t==="symbol"||o["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&o instanceof Symbol}function N(t){var o=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":Q(o,t)?"symbol":o}function G(t){if(typeof t=="undefined"||t===null)return""+t;var o=N(t);if(o==="object"){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return o}function _(t){var o=G(t);switch(o){case"array":case"object":return"an "+o;case"boolean":case"date":case"regexp":return"a "+o;default:return o}}function ee(t){return!t.constructor||!t.constructor.name?S:t.constructor.name}return v.checkPropTypes=u,v.PropTypes=v,v}}).call(O,e(5))},function(p,O){function e(a){return function(){return a}}var i=function(){};i.thatReturns=e,i.thatReturnsFalse=e(!1),i.thatReturnsTrue=e(!0),i.thatReturnsNull=e(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(a){return a},p.exports=i},function(p,O,e){(function(i){function a(h,s,b,n,u,d,g,f){if(!h){var r;if(s===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[b,n,u,d,g,f],S=0;r=new Error(s.replace(/%s/g,function(){return l[S++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}p.exports=a}).call(O,e(5))},function(p,O,e){(function(i){var a=e(7),h=a;p.exports=h}).call(O,e(5))},function(p,O){var e=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function h(b){if(b==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(b)}function s(){try{if(!Object.assign)return!1;var b=new String("abc");if(b[5]="de",Object.getOwnPropertyNames(b)[0]==="5")return!1;for(var n={},u=0;u<10;u++)n["_"+String.fromCharCode(u)]=u;var d=Object.getOwnPropertyNames(n).map(function(f){return n[f]});if(d.join("")!=="0123456789")return!1;var g={};return"abcdefghijklmnopqrst".split("").forEach(function(f){g[f]=f}),Object.keys(Object.assign({},g)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}p.exports=s()?Object.assign:function(b,n){for(var u,d=h(b),g,f=1;f<arguments.length;f++){u=Object(arguments[f]);for(var r in u)i.call(u,r)&&(d[r]=u[r]);if(e){g=e(u);for(var l=0;l<g.length;l++)a.call(u,g[l])&&(d[g[l]]=u[g[l]])}}return d}},function(p,O){var e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";p.exports=e},function(p,O,e){(function(i){function a(h,s,b,n,u){}p.exports=a}).call(O,e(5))},function(p,O,e){var i=e(7),a=e(8),h=e(11);p.exports=function(){function s(u,d,g,f,r,l){l!==h&&a(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}s.isRequired=s;function b(){return s}var n={array:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:b,element:s,instanceOf:b,node:s,objectOf:b,oneOf:b,oneOfType:b,shape:b,exact:b};return n.checkPropTypes=i,n.PropTypes=n,n}},function(p,O){p.exports=re.exports},function(p,O){var e=function(h,s){return h===s};function i(a){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,s=void 0,b=[],n=void 0,u=!1,d=function(r,l){return h(r,b[l])},g=function(){for(var r=arguments.length,l=Array(r),S=0;S<r;S++)l[S]=arguments[S];return u&&s===this&&l.length===b.length&&l.every(d)||(u=!0,s=this,b=l,n=a.apply(this,l)),n};return g}p.exports=i}])})(oe);var ge=se(oe.exports);const Pe=()=>{const[L]=U.useForm(),[p,O]=re.exports.useState();async function e(){const n=L.getFieldsValue();console.log("onSearch: ",n);const u=await te.searchApi.search({query:`body:${n.keyword}`,type:le.Note,limit:100,order_by:"user_updated_time",order_dir:"DESC",fields:["id","title","body"]});console.log("res: ",u),O(u.items),h(void 0)}async function i(n){const u=L.getFieldsValue();await te.noteApi.update({id:n.id,body:n.body.replaceAll(u.keyword,u.replaceText)}),await e(),ae.success(H.t("replace.msg.replace"))}const[a,h]=re.exports.useState();async function s(n){const u=L.getFieldsValue();h({body:n.body,keyword:u.keyword})}async function b(){if(!p||!await L.validateFields())return;const n=L.getFieldsValue();await ce.forEach(p,fe(async u=>{await te.noteApi.update({id:u.id,body:u.body.replaceAll(n.keyword,n.replaceText)})},10)),await e(),ae.success(H.t("replace.msg.replaceAll"))}return A.createElement(de,{title:H.t("replace.title"),className:ue.ReplaceView},A.createElement(U,{form:L,initialValues:{keyword:"",replaceText:""}},A.createElement(U.Item,{name:"keyword",label:H.t("replace.form.keyword"),rules:[{required:!0}]},A.createElement(ie,null)),A.createElement(U.Item,{name:"replaceText",label:H.t("replace.form.replaceText"),rules:[{required:!0}]},A.createElement(ie,null)),A.createElement(U.Item,null,A.createElement(he,null,A.createElement(K,{type:"primary",onClick:e},H.t("replace.action.search")),A.createElement(K,{danger:!0,onClick:b},H.t("replace.action.replaceAll"))))),A.createElement("div",{className:ue.content},A.createElement(ne,{dataSource:p,renderItem:n=>A.createElement(ne.Item,{key:n.id,actions:[A.createElement(K,{onClick:()=>i(n)},H.t("replace.action.replace")),A.createElement(K,{onClick:()=>s(n)},H.t("replace.action.preview"))]},A.createElement(ne.Item.Meta,{title:n.title}))}),a&&A.createElement("pre",null,A.createElement(ge,{textToHighlight:a.body,searchWords:[a.keyword]}))))};export{Pe as default};
